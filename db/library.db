CREATE TABLE public.categorias (
	categoria_id serial4 NOT NULL,
	nombre varchar(100) NOT NULL,
	CONSTRAINT categorias_nombre_key UNIQUE (nombre),
	CONSTRAINT categorias_pkey PRIMARY KEY (categoria_id)
);

CREATE TABLE public.compradores (
	comprador_id int4 NOT NULL,
	user_id int4 NOT NULL,
	CONSTRAINT compradores_pkey PRIMARY KEY (comprador_id)
);

CREATE TABLE public.compras (
	compra_id serial4 NOT NULL,
	comprador_id int4 NOT NULL,
	fecha_compra timestamp DEFAULT CURRENT_TIMESTAMP NULL,
	total numeric(10, 2) NOT NULL,
	CONSTRAINT compras_pkey PRIMARY KEY (compra_id)
);

CREATE TABLE public.detallescompra (
	detalle_id serial4 NOT NULL,
	compra_id int4 NOT NULL,
	libro_id int4 NOT NULL,
	cantidad int4 NOT NULL,
	precio_unitario numeric(10, 2) NOT NULL,
	CONSTRAINT detallescompra_pkey PRIMARY KEY (detalle_id)
);

CREATE TABLE public.detallesventa (
	detalle_id serial4 NOT NULL,
	venta_id int4 NOT NULL,
	libro_id int4 NOT NULL,
	cantidad int4 NOT NULL,
	precio_unitario numeric(10, 2) NOT NULL,
	CONSTRAINT detallesventa_pkey PRIMARY KEY (detalle_id)
);

CREATE TABLE public.direcciones (
	direccion_id serial4 NOT NULL,
	user_id int4 NOT NULL,
	calle varchar(255) NOT NULL,
	ciudad varchar(100) NOT NULL,
	pais varchar(100) NOT NULL,
	CONSTRAINT direcciones_pkey PRIMARY KEY (direccion_id)
);

CREATE TABLE public.libros (
	libro_id serial4 NOT NULL,
	titulo varchar(255) NOT NULL,
	autor varchar(255) NOT NULL,
	fecha_publicacion date NOT NULL,
	precio numeric(10, 2) NOT NULL,
	stock int4 NOT NULL,
	categoria_id int4 NULL,
	CONSTRAINT libros_pkey PRIMARY KEY (libro_id)
);

CREATE TABLE public.reseñas (
	reseña_id serial4 NOT NULL,
	libro_id int4 NOT NULL,
	user_id int4 NOT NULL,
	calificacion int4 NULL,
	comentario text NULL,
	fecha timestamp DEFAULT CURRENT_TIMESTAMP NULL,
	CONSTRAINT reseñas_calificacion_check CHECK (((calificacion >= 1) AND (calificacion <= 5))),
	CONSTRAINT reseñas_pkey PRIMARY KEY ("reseña_id")
);

CREATE TABLE public.users (
	user_id serial4 NOT NULL,
	username varchar(50) NOT NULL,
	"password" varchar(255) NOT NULL,
	email varchar(100) NOT NULL,
	user_type varchar(100) NOT NULL,
	CONSTRAINT users_email_key UNIQUE (email),
	CONSTRAINT users_pkey PRIMARY KEY (user_id),
	CONSTRAINT users_username_key UNIQUE (username)
);

CREATE TABLE public.vendedores (
	vendedor_id int4 NOT NULL,
	user_id int4 NOT NULL,
	CONSTRAINT vendedores_pkey PRIMARY KEY (vendedor_id)
);

CREATE TABLE public.ventas (
	venta_id serial4 NOT NULL,
	vendedor_id int4 NOT NULL,
	fecha_venta timestamp DEFAULT CURRENT_TIMESTAMP NULL,
	total numeric(10, 2) NOT NULL,
	CONSTRAINT ventas_pkey PRIMARY KEY (venta_id)
);
